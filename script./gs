function refreshMaster() {
  const ss = SpreadsheetApp.getActive();
  
  const srcNames = [
    'Event Type A','Event Type B','Event Type C','Event Type D','Event Type E', 'Event Type F','Event Type G','Event Type H','Event Type I','Event Type J','Event Type K','Event Type L','Event Type M','Event Type N','Event Type O','Event Type P','Event Type Q'
  ];
  
  const masterName = '2025/2026';
  const master = ss.getSheetByName(masterName);
  if (!master) {
    throw new Error(`No sheet named "${masterName}" found.`);
  }
  
  const header = [
    'Start Date','End Date','Weekday','Event Type','Event/Activity Name','Location','# of Children Attending',
    '# of Adults Attending','Community Partners','Type of Partner','Paid Attendance','Unpaid Attendance',
    'Attendance by Donation','Attendance by Discount','Total Attendance','New Memberships','Event/Activity Revenue',
    'Number of Artists Hired','Fees Paid to Artists'
  ];
  const numCols = header.length;
  
  let allData = [];
  srcNames.forEach(name => {
    const sh = ss.getSheetByName(name);
    if (!sh) return;
    const lastRow = sh.getLastRow();
    if (lastRow < 2) return;
    const data = sh
      .getRange(2, 1, lastRow - 1, numCols)
      .getValues();
    data.forEach(row => {
      if (row.some(cell => cell !== '')) {
        allData.push(row);
      }
    });
  });
  
  master.clearContents();
  master.getRange(1, 1, 1, numCols).setValues([header]);
  if (allData.length) {
    master
      .getRange(2, 1, allData.length, numCols)
      .setValues(allData);
  }
}
